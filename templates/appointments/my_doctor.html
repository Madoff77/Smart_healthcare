{% extends 'base.html' %}
{% block title %}Mes RDV (Médecin){% endblock %}
{% block content %}
  <h1>Mes rendez-vous (Médecin)</h1>
  {% if appts %}
    <table class="table">
      <thead>
        <tr>
          <th>Date</th><th>Heure</th><th>Patient</th><th>Statut</th><th>Motif</th><th>Gérer</th>
        </tr>
      </thead>
      <tbody>
        {% for a in appts %}
        <tr>
          <td>{{ a.start_time|date:"d/m/Y" }}</td>
          <td>{{ a.start_time|date:"H:i" }} → {{ a.end_time|date:"H:i" }}</td>
          <td>{{ a.patient.user.get_full_name|default:a.patient.user.username }}</td>
          <td>{{ a.get_status_display }}</td>
          <td>{{ a.reason|default:"—" }}</td>
          <td>
            {% if a.can_manage %}
              <a class="btn" href="{% url 'appointments_html:manage' a.id %}">Gérer</a>
            {% else %}—{% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <div class="card">Aucun rendez-vous pour le moment.</div>
  {% endif %}
  {% if page.object_list %}
  <table class="table"> … {% for a in page.object_list %} … {% endfor %}</table>
  {% if page.paginator.num_pages > 1 %}
    <p>
      {% if page.has_previous %}<a class="btn" href="?page={{ page.previous_page_number }}">←</a>{% endif %}
      Page {{ page.number }}/{{ page.paginator.num_pages }}
      {% if page.has_next %}<a class="btn" href="?page={{ page.next_page_number }}">→</a>{% endif %}
    </p>
  {% endif %}
{% else %}
  <div class="card">Aucun rendez-vous pour le moment.</div>
{% endif %}

{% endblock %}