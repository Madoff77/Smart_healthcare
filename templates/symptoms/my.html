{% extends 'base.html' %}
{% block title %}Mes symptômes{% endblock %}
{% block content %}
  <h1>Mes symptômes</h1>

  <p>
    <a class="btn" href="{% url 'symptoms_html:new_symptom' %}">Ajouter un symptôme</a>
    <a class="btn" href="{% url 'symptoms_html:export_my_symptoms_csv' %}">Exporter CSV</a>
  </p>

  <form method="get" style="margin-bottom:1rem">
    <input type="text" name="q" value="{{ q }}" placeholder="Rechercher…">
    <select name="severity">
      <option value="">Toutes sévérités</option>
      <option value="mild" {% if severity == 'mild' %}selected{% endif %}>Léger</option>
      <option value="moderate" {% if severity == 'moderate' %}selected{% endif %}>Modéré</option>
      <option value="severe" {% if severity == 'severe' %}selected{% endif %}>Sévère</option>
    </select>
    <button type="submit">Filtrer</button>
  </form>

  {% if items %}
    <table class="table">
      <thead>
        <tr><th>Date</th><th>Sévérité</th><th>Description</th><th>Actions</th></tr>
      </thead>
      <tbody>
        {% for s in items %}
          <tr>
            <td>{{ s.created_at|date:"d/m/Y H:i" }}</td>
            <td>{{ s.get_severity_display|default:"—" }}</td>
            <td>{{ s.description|linebreaksbr }}</td>
            <td>
              <a class="btn" href="{% url 'symptoms_html:edit_symptom' s.id %}">Modifier</a>
              <a class="btn danger" href="{% url 'symptoms_html:delete_symptom' s.id %}">Supprimer</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <div class="card">Aucun symptôme enregistré.</div>
  {% endif %}
{% endblock %}
